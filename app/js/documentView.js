// Generated by CoffeeScript 1.7.1
(function() {
  var documentView;

  documentView = angular.module('documentView', ['musicSVG']);

  documentView.directive('documentView', function() {
    return {
      restrict: 'A',
      require: 'ngModel',
      scope: {
        ngModel: '='
      },
      controller: [
        '$scope', function($scope) {
          $scope.model = {
            meta: {
              measures: [{}, {}]
            },
            staves: [
              {
                measures: [
                  {
                    notes: [
                      {
                        pitch: 69,
                        duration: {
                          n: 1,
                          d: 4
                        }
                      }, {
                        pitch: 70,
                        duration: {
                          n: 1,
                          d: 2
                        }
                      }, {
                        pitch: 71,
                        duration: {
                          n: 1,
                          d: 4
                        }
                      }
                    ]
                  }, {
                    notes: [
                      {
                        pitch: 71,
                        duration: {
                          n: 1,
                          d: 2
                        }
                      }, {
                        pitch: 72,
                        duration: {
                          n: 1,
                          d: 4
                        }
                      }, {
                        pitch: 73,
                        duration: {
                          n: 1,
                          d: 4
                        }
                      }
                    ]
                  }
                ]
              }
            ]
          };
          return $scope.width = function(measureIndex) {
            return _.max(_($scope.model.staves).map(function(staff) {
              return 2 * staff.measures[measureIndex].notes.length + 1;
            }));
          };
        }
      ],
      template: '<div class="staff"> <svg ng-meta-measure ng-repeat="measure in model.meta.measures" ng-model="measure" size="{{width($index)}}" class="document staff"/> </div> <br> <div class="staff"> <svg ng-measure ng-repeat="measure in model.staves[0].measures" ng-model="measure" size="{{width($index)}}" class="document staff"/> </div>'
    };
  });

}).call(this);
